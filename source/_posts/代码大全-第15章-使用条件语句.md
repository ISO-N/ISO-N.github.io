---
title: 第15章 使用条件语句
date: 2026-02-17 15:25:04
categories:
- [软件工程, 理论]
tags:
- 代码大全
---
本章讨论如何正确、高效地使用 `if-else` 语句和 `case`（`switch`）语句，是编写清晰控制流的关键。

---

## if-else 语句

### 简单 if 语句指南

- 先处理**正常路径**（normal case），再处理异常情况
- 确保 `if` 子句后的分支是正确的——不要把判断条件写反
- 考虑 `else` 子句：即使暂时不需要，也应思考是否需要补充
- 测试边界条件——等号（`>=` vs `>`）是常见错误源

### if-else 链的建议

- 把**最常见的情况放在最前面**，提高可读性和性能
- 确保所有情况都被覆盖，必要时加一个兜底的 `else` 分支
- 如果 `if-else` 链超过 3～4 层，考虑用 `case` 语句、表驱动法或多态替代

### 常见错误

- 悬挂 `else`（dangling else）：`else` 与哪个 `if` 配对不明确，应使用花括号消除歧义
- 空的 `if` 或 `else` 子句：如果某个分支什么都不做，至少加注释说明原因
- 在 `if` 判断中赋值（如 `if (a = b)`），容易与比较（`==`）混淆

---

## case 语句（switch）

### 选择有效的排列顺序

- **按字母或数字顺序**排列——当每个 case 同等重要时
- **把正常情况放前面**——优先展示最常用的路径
- **按执行频率排列**——最常执行的 case 放在最前面

### 使用 case 语句的建议

- 简化每个 case 中的操作：如果某个 case 的代码超过几行，应提取为子程序
- 不要为了使用 `case` 而刻意制造虚假的变量——如果数据不适合 `case`，就用 `if-else`
- 把 `default` 子句**只用于检测真正的默认情况**，不要把最后一个合法 case 放到 `default` 中

### default 子句的用法

- 用于检测**不该出现的情况**——在 `default` 中放置断言或错误处理代码
- 如果 `default` 确实不该被执行到，加一条**断言**或**错误日志**，有助于排查问题
- 在某些语言中，每次修改 `case` 时都要检查 `default` 是否仍然正确

### fall-through 问题

- 避免使用 fall-through（一个 case 执行完后落入下一个 case）
- 如果必须使用，一定要加**注释**说明这是有意为之
- 某些语言（如 C/C++）默认 fall-through，务必在每个 case 末尾加 `break`

---

## 关键原则总结

| **原则** | **说明** |
| --- | --- |
| 正常情况优先 | 把最常见 / 最正常的路径放在 `if` 或第一个 `case` 中 |
| 覆盖所有情况 | 始终考虑 `else` 和 `default` 分支，即使只是加断言 |
| 减少嵌套深度 | 超过 3 层嵌套时，用提前返回、卫语句或重构来简化 |
| 简化判断条件 | 复杂布尔表达式应提取为有意义的布尔变量或函数 |
| 用花括号消除歧义 | 即使只有一条语句，也建议使用花括号包裹 |