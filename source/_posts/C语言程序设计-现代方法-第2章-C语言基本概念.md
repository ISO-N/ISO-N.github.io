---
title: 第2章 C语言基本概念
date: 2026-02-17 02:20:20
categories:
- [编程技术, C]
tags:
- C语言程序设计-现代方法
---
## 2.1 编写一个简单的程序

一个最简单的 C 程序示例：

```c
#include <stdio.h>

int main(void)
{
    printf("Hello, World!\n");
    return 0;
}
```

- `#include <stdio.h>`：**预处理指令**，包含标准输入/输出库的信息
- `int main(void)`：**主函数**，程序的入口点；`int` 表示返回整数值，`void` 表示不接受参数
- `printf`：标准库函数，用于格式化输出
- `return 0`：程序正常结束，返回状态码 0 给操作系统

## 2.2 编译和链接

C 程序从源代码到可执行文件需要经过三个步骤：

1. **预处理（Preprocessing）**：处理以 `#` 开头的指令（如 `#include`、`#define`），由**预处理器**完成
2. **编译（Compiling）**：将预处理后的代码翻译成**目标代码**（机器指令），由**编译器**完成
3. **链接（Linking）**：将目标代码与库函数的代码合并，生成**可执行程序**，由**链接器**完成

<aside>
💡

在 GCC 中，可以用 `gcc -o hello hello.c` 一步完成预处理、编译和链接。

</aside>

## 2.3 简单程序的一般形式

C 程序的基本框架：

```c
指令

int main(void)
{
    语句
}
```

- **指令**：在编译前由预处理器处理的命令（如 `#include`、`#define`）
- **函数**：C 程序由一个或多个**函数**组成，每个函数包含若干**语句**
- **main 函数**：每个 C 程序都必须有且仅有一个 `main` 函数，程序从此处开始执行

## 2.4 注释

- **传统注释**（C89）：`/* 注释内容 */`，可跨多行
- **单行注释**（C99）：`// 注释内容`，到行末结束

```c
/* 这是一个
   多行注释 */

// 这是单行注释
```

<aside>
⚠️

`/* */` 注释**不能嵌套**。例如 `/* a /* b */ c */` 会导致错误，因为第一个 `*/` 就结束了注释。

</aside>

## 2.5 变量和赋值

### 变量的类型

- C 语言中每个变量都必须有一个**类型**（type）
- `int`：整数类型（如 `0`、`1`、`-10`）
- `float`：浮点数类型（如 `3.14`、`0.5`）

### 变量的声明

变量使用前必须**声明**（declare）：

```c
int height;
float profit;
int height, length, width;  // 同时声明多个同类型变量
```

### 变量的赋值

使用 `=` 运算符赋值：

```c
height = 8;
profit = 2150.48f;
```

<aside>
📌

在 C89 中，变量声明必须出现在**语句块的开头**（即所有可执行语句之前）。C99 取消了这一限制，允许在任意位置声明变量。

</aside>

### 打印变量的值

```c
printf("Height: %d\n", height);   // %d —— 打印 int
printf("Profit: %f\n", profit);   // %f —— 打印 float
```

## 2.6 读取输入

使用 `scanf` 读取用户输入：

```c
int i;
scanf("%d", &i);  // 读取一个整数，存入变量 i
```

- `%d`：告诉 `scanf` 读取一个整数
- `&i`：取变量 `i` 的**地址**，`scanf` 需要知道在哪里存放读取的值

<aside>
⚠️

使用 `scanf` 时**不要忘记 `&`**！遗漏 `&` 是 C 语言初学者最常见的错误之一，可能导致不可预测的行为。

</aside>

## 2.7 定义常量的名字

使用 `#define` 定义**宏**（常量）：

```c
#define INCHES_PER_POUND 166
```

- 预处理时，程序中所有 `INCHES_PER_POUND` 会被替换为 `166`
- 按惯例，宏名使用**全大写字母**
- `#define` 不是语句，末尾**不加分号**

## 2.8 标识符

**标识符**（identifier）是变量、函数、宏等的名字，命名规则：

- 可以包含**字母**、**数字**和**下划线** `_`
- 必须以**字母或下划线**开头（不能以数字开头）
- **区分大小写**：`sum`、`Sum`、`SUM` 是三个不同的标识符

<aside>
📌

**关键字**（如 `int`、`return`、`if` 等）是保留的，不能用作标识符。C89 有 **32** 个关键字，C99 新增了 **5** 个。

</aside>

## 2.9 C程序的布局

C 语言对代码格式要求宽松，但良好的布局风格有助于可读性：

- **缩进**：函数体内的语句应缩进
- **空行**：用空行分隔逻辑段落
- **空格**：运算符两侧加空格，增加可读性
- **花括号**：保持风格一致（如 K&R 风格或 Allman 风格）

```c
// K&R 风格
int main(void) {
    printf("Hello\n");
    return 0;
}

// Allman 风格
int main(void)
{
    printf("Hello\n");
    return 0;
}
```

> C 语言中，**token**（记号）之间的空白符数量不影响程序含义，但合理使用空白符能极大提升代码可读性。
>