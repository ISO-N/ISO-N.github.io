---
title: 第3章 格式化输入 输出
date: 2026-02-17 02:20:20
categories:
- [编程技术, C]
tags:
- C语言程序设计-现代方法
---
## 3.1 printf 函数

`printf` 用于将格式化的输出写到标准输出（屏幕）。

```c
printf("格式串", 表达式1, 表达式2, ...);
```

- **格式串**：包含普通字符和**转换说明**（以 `%` 开头）
- 普通字符会原样输出，转换说明会被后面对应的表达式的值替换

### 转换说明

转换说明的一般形式：

```
%m.pX
```

- `m`（可选）：**最小字段宽度**，指定输出的最少字符数。不足时用空格补齐（默认右对齐）
- `.p`（可选）：**精度**，含义取决于转换说明符 `X`
- `X`：**转换说明符**，指定输出的类型

常用转换说明符：

| 说明符 | 含义 | 示例 |
| --- | --- | --- |
| `%d` | 十进制整数 | `printf("%d", 42)` → `42` |
| `%f` | 浮点数（小数形式） | `printf("%f", 3.14)` → `3.140000` |
| `%e` | 浮点数（科学计数法） | `printf("%e", 3.14)` → `3.140000e+00` |
| `%g` | 浮点数（自动选择 `%f` 或 `%e`） | `printf("%g", 3.14)` → `3.14` |
| `%%` | 输出一个 `%` 字符 | `printf("%%")` → `%` |

### 精度的含义

- `%d`：精度表示最少输出的数字位数（不足补 0）
- `%f`：精度表示小数点后的位数（默认 6 位）
- `%e`：精度表示小数点后的位数
- `%g`：精度表示有效数字的最大位数

### 标志（flags）

标志放在 `%` 后、字段宽度前：

- `-`：**左对齐**（默认是右对齐）
- `+`：始终显示正负号
- `0`：用 `0` 而非空格填充

```c
printf("%-10d", 42);    // "42        "（左对齐，宽度10）
printf("%010d", 42);     // "0000000042"（0填充，宽度10）
printf("%+d", 42);       // "+42"
```

## 3.2 scanf 函数

`scanf` 用于从标准输入（键盘）读取格式化数据。

```c
scanf("格式串", &变量1, &变量2, ...);
```

<aside>
⚠️

`scanf` 的参数必须是**指针**（变量的地址），所以普通变量前要加 `&`。忘记 `&` 是最常见的错误之一。

</aside>

### scanf 的工作原理

`scanf` 通过格式串逐个匹配输入：

1. **转换说明**（如 `%d`）：跳过空白字符，然后尝试读取并转换对应类型的数据
2. **空白字符**（空格、制表符、换行）：匹配输入中零个或多个任意空白字符
3. **其他字符**：必须与输入中的字符精确匹配

### scanf 中的常用转换说明

| 说明符 | 含义 |
| --- | --- |
| `%d` | 读取十进制整数 |
| `%f` | 读取浮点数（`float`） |
| `%lf` | 读取浮点数（`double`） |
| `%c` | 读取单个字符（**不跳过**空白） |
| `%s` | 读取字符串（到空白为止） |

### scanf 与 printf 的区别

<aside>
📌

**`printf`** 中 `%f` 可同时用于 `float` 和 `double`；但在 **`scanf`** 中，`%f` 仅用于 `float`，读取 `double` 必须使用 `%lf`。

</aside>

### scanf 的返回值

- `scanf` 返回**成功读取并赋值的项数**
- 可以利用返回值检测输入是否合法：

```c
if (scanf("%d", &n) != 1) {
    printf("输入错误！\n");
}
```

### 混合使用 printf 和 scanf

一个完整示例：

```c
#include <stdio.h>

int main(void)
{
    int height, length, width, volume;

    printf("请输入长方体的长: ");
    scanf("%d", &length);
    printf("请输入长方体的宽: ");
    scanf("%d", &width);
    printf("请输入长方体的高: ");
    scanf("%d", &height);

    volume = length * width * height;
    printf("体积为: %d\n", volume);

    return 0;
}
```

> `printf` 负责**输出**，`scanf` 负责**输入**，二者的格式串语法相似但含义有差异，使用时需注意区分。
>