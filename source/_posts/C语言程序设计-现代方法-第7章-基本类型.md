---
title: 第7章 基本类型
date: 2026-02-17 02:20:23
categories:
- [编程技术, C]
tags:
- C语言程序设计-现代方法
---
## 7.1 整数类型

C 语言提供多种整数类型，分为**有符号**和**无符号**两大类。

### 有符号整数类型

按照存储大小从小到大：

| 类型 | 最小范围（C 标准保证） | 典型大小 |
| --- | --- | --- |
| `short` / `short int` | −32,768 ~ 32,767 | 16 位 |
| `int` | −32,768 ~ 32,767 | 16 位或 32 位 |
| `long` / `long int` | −2,147,483,648 ~ 2,147,483,647 | 32 位 |
| `long long` / `long long int`（C99） | −9,223,372,036,854,775,808 ~ …807 | 64 位 |

C 标准只保证：`short` ≤ `int` ≤ `long` ≤ `long long`

### 无符号整数类型

在类型前加 `unsigned` 关键字，范围从 0 开始，最大值约为有符号类型的**两倍**：

```c
unsigned short us;
unsigned int ui;       // 可简写为 unsigned ui;
unsigned long ul;
unsigned long long ull; // C99
```

### 整数常量（字面量）

| 进制 | 前缀 | 示例 |
| --- | --- | --- |
| 十进制 | 无 | `42` |
| 八进制 | `0` | `052`（等于十进制 42） |
| 十六进制 | `0x` 或 `0X` | `0x2A`（等于十进制 42） |

后缀用于指定类型：

- `L` 或 `l`：`long`（如 `42L`）
- `LL` 或 `ll`：`long long`（如 `42LL`，C99）
- `U` 或 `u`：`unsigned`（如 `42U`）
- 可组合：`42UL`、`42ULL`

### 整数溢出

<aside>
⚠️

- **有符号整数溢出**是**未定义行为**，结果不可预测
- **无符号整数溢出**是有定义的，结果会**取模**（对 $2^n$ 取余）

```c
unsigned short x = 65535;
x++;  // x 变为 0（回绕）
```

</aside>

### 读写整数

| 类型 | printf / scanf 转换说明 |
| --- | --- |
| `short` | `%hd` |
| `unsigned short` | `%hu` |
| `int` | `%d` |
| `unsigned int` | `%u` |
| `long` | `%ld` |
| `unsigned long` | `%lu` |
| `long long`（C99） | `%lld` |
| `unsigned long long`（C99） | `%llu` |

八进制用 `%o`，十六进制用 `%x`（或 `%X`）。

## 7.2 浮点类型

| 类型 | 典型大小 | 精度（十进制有效位） |
| --- | --- | --- |
| `float` | 32 位 | 约 6 位 |
| `double` | 64 位 | 约 15 位 |
| `long double` | 80 位或 128 位 | ≥ 15 位 |

C 标准保证：`float` ≤ `double` ≤ `long double`

### 浮点常量

```c
3.14          // double（默认）
3.14f         // float（后缀 f 或 F）
3.14L         // long double（后缀 l 或 L）
1e3           // 1000.0（科学计数法）
2.5e-4        // 0.00025
```

<aside>
📌

浮点常量默认类型为 **`double`**，不是 `float`。要指定 `float` 必须加 `f` 后缀。

</aside>

### 读写浮点数

| 类型 | printf | scanf |
| --- | --- | --- |
| `float` | `%f` `%e` `%g` | `%f` `%e` `%g` |
| `double` | `%f` `%e` `%g` | `%lf` `%le` `%lg` |
| `long double` | `%Lf` `%Le` `%Lg` | `%Lf` `%Le` `%Lg` |

<aside>
⚠️

`printf` 中 `float` 和 `double` 都用 `%f`（`float` 传参时自动提升为 `double`），但 `scanf` 中必须区分：`float` 用 `%f`，`double` 用 `%lf`。

</aside>

## 7.3 字符类型

### char 类型

`char` 用于存储单个字符，本质上是一个**小整数**（通常 8 位）：

```c
char ch = 'A';     // 存储的是字符 'A' 的 ASCII 码值 65
char ch2 = 65;     // 同样是 'A'
```

- `char` 可以参与算术运算：`'a' + 1` 结果为 `'b'`
- `char` 是否有符号是**由实现定义的**，如需明确可用 `signed char` 或 `unsigned char`

### 字符常量与 ASCII

字符常量用单引号：`'A'`、`'0'`、`' '`

常用 ASCII 值：

- `'0'` ~ `'9'`：48 ~ 57（连续）
- `'A'` ~ `'Z'`：65 ~ 90（连续）
- `'a'` ~ `'z'`：97 ~ 122（连续）

```c
// 判断是否为数字字符
if (ch >= '0' && ch <= '9')
    digit = ch - '0';   // 字符转数字
```

### 转义序列

| 转义序列 | 含义 |
| --- | --- |
| `\n` | 换行 |
| `\t` | 水平制表符 |
| `\\` | 反斜杠 `\` |
| `\'` | 单引号 |
| `\"` | 双引号 |
| `\0` | 空字符（值为 0） |
| `\a` | 响铃 |
| `\b` | 退格 |
| `\r` | 回车 |

### 读写字符

```c
char ch;
scanf("%c", &ch);    // 读取单个字符（不跳过空白）
printf("%c", ch);    // 输出单个字符
```

也可以使用 `getchar()` 和 `putchar()`：

```c
ch = getchar();      // 读取一个字符
putchar(ch);         // 输出一个字符
```

<aside>
💡

`getchar` / `putchar` 比 `scanf` / `printf` 更快，因为它们不需要解析格式串。在需要逐字符处理输入时推荐使用。

</aside>

## 7.4 类型转换

### 隐式转换

当不同类型的值出现在同一表达式中，C 会自动进行**隐式类型转换**：

1. **整数提升**：`char` 和 `short` 在运算时自动提升为 `int`
2. **常规算术转换**：当两个操作数类型不同时，"较窄"的类型转换为"较宽"的类型

转换优先级（从低到高）：

```
int → unsigned int → long → unsigned long → long long → unsigned long long → float → double → long double
```

### 赋值时的转换

赋值时，右侧值转换为左侧变量的类型：

```c
int i = 3.7;       // i = 3（截断小数部分）
float f = 10;      // f = 10.0
```

<aside>
⚠️

将浮点数赋给整数变量时，小数部分被**截断**（不是四舍五入）。将较大整数赋给较小类型时可能发生**溢出**。

</aside>

### 强制类型转换（cast）

使用 `(类型名)` 进行显式转换：

```c
int a = 7, b = 2;
double result = (double)a / b;   // 3.5，而不是 3
```

- 强制转换**不改变**原变量的值，只是生成一个临时的转换后的值
- 常见用途：避免整数除法截断

## 7.5 类型定义

使用 `typedef` 为已有类型创建**别名**：

```c
typedef int Bool;
Bool flag = 1;

typedef unsigned long size_t;
```

### typedef 的优势

- **可读性**：用有意义的名字替代复杂类型
- **可移植性**：修改底层类型只需改 `typedef` 一处
- **简化复杂类型**：如指向函数的指针等

<aside>
📌

`typedef` 与 `#define` 的区别：`typedef` 是编译器处理的，更安全；`#define` 是预处理器处理的简单文本替换。例如：

```c
#define PTR1 int *
typedef int *PTR2;

PTR1 a, b;    // a 是 int*，但 b 只是 int！
PTR2 c, d;    // c 和 d 都是 int*
```

</aside>

## 7.6 sizeof 运算符

`sizeof` 返回一个类型或表达式所占的**字节数**：

```c
sizeof(int)       // 通常为 4
sizeof(char)      // 总是 1
sizeof(double)    // 通常为 8

int a;
sizeof(a)         // 等于 sizeof(int)
sizeof a          // 对变量可以省略括号（但对类型不行）
```

- `sizeof` 的返回类型是 `size_t`（无符号整数类型）
- 打印 `sizeof` 的结果：C99 用 `%zu`，C89 可转为 `unsigned long` 后用 `%lu`

> 掌握 C 的类型系统是写出正确、高效代码的基础。关键要点：了解各类型的**大小和范围**，注意**隐式转换**可能带来的数据丢失，必要时使用**强制转换**。
>